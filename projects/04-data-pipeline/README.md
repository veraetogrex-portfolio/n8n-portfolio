# –ü–∞—Ä—Å–∏–Ω–≥ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö üìä

ETL –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è —Å–±–æ—Ä–∞ —Ü–µ–Ω –æ—Ç AI-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤, –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ Metabase.

## üìù –û–ø–∏—Å–∞–Ω–∏–µ

–í–æ—Ä–∫—Ñ–ª–æ—É —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–∞—Ä—Å–∏—Ç API —Ä–∞–∑–Ω—ã—Ö AI-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (OpenAI, Anthropic, Google, Azure), —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤ ClickHouse –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤ Metabase.

## üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ü–∞—Ä—Å–∏–Ω–≥ —Ü–µ–Ω**: OpenAI, Anthropic, Google, Azure, Cohere
- ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω
- ‚úÖ **–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- ‚úÖ **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –≤ ClickHouse
- ‚úÖ **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤**: –ö–∞–∫–æ–π –¥–µ—à–µ–≤–ª–µ –¥–ª—è –∫–∞–∫–æ–π –∑–∞–¥–∞—á–∏
- ‚úÖ **ROI –∞–Ω–∞–ª–∏–∑**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
- ‚úÖ **–ê–Ω–æ–º–∞–ª–∏—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Å–∫–∞—á–∫–∏ —Ü–µ–Ω
- ‚úÖ **–ú–µ—Ç–∞base –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: –ö—Ä–∞—Å–∏–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –¥–∏–∞–≥—Ä–∞–º–º—ã

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
OpenAI API
Anthropic API
Google API
Azure API
Cohere API
        ‚Üì
   Parse Prices
        ‚Üì
 Normalize Data
        ‚Üì
Calculate Costs
        ‚Üì
Log to ClickHouse
        ‚Üì
Metabase Dashboard
```

## üîß –¢—Ä–µ–±—É–µ–º—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- OpenAI API (pricing page)
- Anthropic API (pricing)
- Google Cloud API (pricing)
- Azure API (pricing)
- Cohere API (pricing)
- ClickHouse (–∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
- Metabase (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)

## üí∞ –ü—Ä–∏–º–µ—Ä—ã —Ü–µ–Ω

### OpenAI (Jan 2026)
```json
{
  "provider": "openai",
  "models": [
    {
      "name": "gpt-4-turbo",
      "input_token_cost": 0.01,      // –∑–∞ 1K —Ç–æ–∫–µ–Ω–æ–≤
      "output_token_cost": 0.03
    },
    {
      "name": "gpt-3.5-turbo",
      "input_token_cost": 0.0005,
      "output_token_cost": 0.0015
    }
  ]
}
```

### Anthropic (Claude)
```json
{
  "provider": "anthropic",
  "models": [
    {
      "name": "claude-3-opus",
      "input_token_cost": 0.015,
      "output_token_cost": 0.075
    },
    {
      "name": "claude-3-sonnet",
      "input_token_cost": 0.003,
      "output_token_cost": 0.015
    }
  ]
}
```

## üìä –ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏–∑–æ–≤

### 1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω
```
–ó–∞–¥–∞—á–∞: 1M –≤—Ö–æ–¥—è—â–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ + 100K –≤—ã—Ö–æ–¥—è—â–∏—Ö (gpt-4-level)

OpenAI GPT-4-turbo:
  Input:  1M √ó $0.01/1K = $10
  Output: 100K √ó $0.03/1K = $3
  Total: $13

Anthropic Claude-3-Opus:
  Input:  1M √ó $0.015/1K = $15
  Output: 100K √ó $0.075/1K = $7.50
  Total: $22.50

Winner: OpenAI (39% –¥–µ—à–µ–≤–ª–µ)
```

### 2. ROI –∞–Ω–∞–ª–∏–∑
```
OpenAI Usage –∑–∞ –º–µ—Å—è—Ü:
  Total cost: $2,500
  Requests processed: 50,000
  Cost per request: $0.05
  Revenue per request: $0.10
  Profit margin: 100%

Google API Usage:
  Total cost: $3,200
  Requests processed: 50,000
  Cost per request: $0.064
  Profit margin: 56%

Recommendation: Migrating to OpenAI saves $700/month
```

### 3. –¢—Ä–µ–Ω–¥—ã
```
–ê–Ω–∞–ª–∏–∑ –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤:
- GPT-4 —Ü–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∞ 15%
- Claude 3 –≤—ã—à–ª–∞ –∏ –¥–µ—à–µ–≤–ª–µ GPT-4
- Google API —Å—Ç–∞–±–∏–ª—å–Ω–∞
- Anthropic —Ä–∞—Å—Ç–µ—Ç –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏
```

## üöÄ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] –ü–∞—Ä—Å–µ—Ä –¥–ª—è OpenAI API
- [ ] –ü–∞—Ä—Å–µ—Ä –¥–ª—è Anthropic API
- [ ] –ü–∞—Ä—Å–µ—Ä –¥–ª—è Google API
- [ ] –ü–∞—Ä—Å–µ—Ä –¥–ª—è Azure API
- [ ] –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ –µ–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
- [ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ ClickHouse
- [ ] –†–∞—Å—á–µ—Ç ROI –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
- [ ] –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π
- [ ] Metabase dashboard
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã

## üìã ClickHouse —Å—Ö–µ–º–∞

```sql
CREATE TABLE ai_provider_prices (
  date Date,
  provider String,          -- openai, anthropic, google
  model_name String,        -- gpt-4-turbo, claude-3
  task_type String,         -- chat, embedding, moderation
  input_token_cost Decimal(10, 8),  -- –∑–∞ 1K —Ç–æ–∫–µ–Ω–æ–≤
  output_token_cost Decimal(10, 8),
  context_window UInt32,
  max_output_tokens UInt32,
  parsed_at DateTime
) ENGINE = MergeTree()
ORDER BY (date, provider, model_name);

CREATE TABLE usage_logs (
  timestamp DateTime,
  provider String,
  model String,
  input_tokens UInt32,
  output_tokens UInt32,
  cost_usd Decimal(10, 4),
  project String,
  user_id String
) ENGINE = MergeTree()
ORDER BY (timestamp, provider);
```

## üìà Metabase –¥–∞—à–±–æ—Ä–¥ –∏–¥–µ–∏

### 1. –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ü–µ–Ω
```
Model            | Provider   | Input (1K)  | Output (1K) | Context |
gpt-4-turbo      | OpenAI     | $0.010      | $0.030      | 128K    |
claude-3-opus    | Anthropic  | $0.015      | $0.075      | 200K    |
gemini-1.5       | Google     | $0.0025     | $0.0075     | 2M      |
```

### 2. –ì—Ä–∞—Ñ–∏–∫ —Ç—Ä–µ–Ω–¥–∞ —Ü–µ–Ω
```
Y-axis: –¶–µ–Ω–∞ –∑–∞ 1K —Ç–æ–∫–µ–Ω–æ–≤
X-axis: –î–∞—Ç–∞
Lines: –ö–∞–∂–¥—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –∏ –º–æ–¥–µ–ª—å
```

### 3. ROI –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º
```
Pie chart: –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –ø–æ –ø—Ä–æ–µ–∫—Ç–∞–º
Bar chart: –ó–∞—Ç—Ä–∞—Ç—ã vs Revenue –¥–ª—è –∫–∞–∂–¥–æ–≥–æ
```

### 4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```
"–ï—Å–ª–∏ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ Anthropic Claude —ç–∫–æ–Ω–æ–º–∏–º $X –≤ –º–µ—Å—è—Ü"
"Gemini API –∑–∞–º–µ—Ç–Ω–æ –¥–µ—à–µ–≤–ª–µ –¥–ª—è embedding –∑–∞–¥–∞—á"
```

## üí° –û–∂–∏–¥–∞–µ–º—ã–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü—É–±–ª–∏—á–Ω—ã–µ API vs Pricing page
```
Scenario: OpenAI –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è —Ü–µ–Ω, —Ç–æ–ª—å–∫–æ HTML
Solution:
- –ü–∞—Ä—Å–∏—Ç—å HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –∏–∑–≤–ª–µ–∫–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, langsmith.com)
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –†–∞–∑–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
```
OpenAI: –∑–∞ 1K —Ç–æ–∫–µ–Ω–æ–≤
Google: –∑–∞ –º–∏–ª–ª–∏–æ–Ω —Ç–æ–∫–µ–Ω–æ–≤
Azure: –∑–∞ 1000 —á–∞—Å–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

Solution: 
- –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ –µ–¥–∏–Ω—É—é –µ–¥–∏–Ω–∏—Ü—É –≤ ClickHouse
- –•—Ä–∞–Ω–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ–∫–Ω–∞ –∏ –ª–∏–º–∏—Ç—ã
```
Scenario: Claude 3 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç 200K –∫–æ–Ω—Ç–µ–∫—Å—Ç, –Ω–æ –¥–æ—Ä–æ–∂–µ –∑–∞ –±–æ–ª—å—à–∏–µ –æ–∫–Ω–∞
Solution:
- –î–æ–±–∞–≤–∏—Ç—å context_window –≤ —Å—Ö–µ–º—É
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞
```

## üîÑ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

```
–ï–∂–µ–¥–Ω–µ–≤–Ω–æ:
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–Ω OpenAI –∏ Anthropic
  
–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:
  - –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
  - –†–∞—Å—á–µ—Ç —Ç—Ä–µ–Ω–¥–æ–≤ –∏ ROI
  - –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞

–ï–∂–µ–º–µ—Å—è—á–Ω–æ:
  - –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç
  - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
```

---

**–°—Ç–∞—Ç—É—Å:** üìÖ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è (–ø–∞—Ä—Å–∏–Ω–≥ + –∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
